# Canary å‘å¸ƒæŒ‡å—

ä½¿ç”¨ GitHub Actions è‡ªåŠ¨å‘å¸ƒ canary ç‰ˆæœ¬åˆ° npmï¼Œç”¨äº Benchmark æµ‹è¯•ã€‚

## ğŸš€ å¿«é€Ÿä½¿ç”¨ï¼ˆ2 åˆ†é’Ÿï¼‰

### 1. æ‰“å¼€ GitHub Actions
è®¿é—®: https://github.com/YOUR_ORG/open-agent-sdk/actions

### 2. è¿è¡Œ Workflow
1. ç‚¹å‡»å·¦ä¾§ "Publish Canary (Benchmark)"
2. ç‚¹å‡»å³ä¸Šè§’ "Run workflow" æŒ‰é’®
3. é€‰æ‹©é…ç½®ï¼š
   - **Use workflow from**: é€‰æ‹©è¦å‘å¸ƒçš„åˆ†æ”¯
   - **Skip tests**: æµ‹è¯•é‡æ„æœŸé—´å¯ä»¥å‹¾é€‰
4. ç‚¹å‡»ç»¿è‰² "Run workflow" æŒ‰é’®

### 3. ç­‰å¾…å®Œæˆï¼ˆ2-3 åˆ†é’Ÿï¼‰
- æŸ¥çœ‹ Actions è¿è¡Œæ—¥å¿—
- åœ¨ Summary ä¸­æŸ¥çœ‹å®‰è£…å‘½ä»¤

### 4. åœ¨ Daytona å®‰è£…
```bash
# å®‰è£…æœ€æ–° canary ç‰ˆæœ¬
npm install -g @open-agent-sdk/cli@canary

# æˆ–å®‰è£…ç‰¹å®šç‰ˆæœ¬
npm install -g @open-agent-sdk/cli@0.1.0-canary.202602271530
```

## ğŸ”§ é¦–æ¬¡é…ç½®ï¼ˆ10 åˆ†é’Ÿï¼‰

### æ­¥éª¤ 1: åˆ›å»º npm Automation Token

1. **ç™»å½• npm**: https://www.npmjs.com

2. **åˆ›å»º Token**:
   - ç‚¹å‡»å¤´åƒ â†’ "Access Tokens"
   - ç‚¹å‡» "Generate New Token" â†’ "Classic Token"
   - é€‰æ‹© **"Automation"** ç±»å‹ âš ï¸ é‡è¦ï¼
   - å¤åˆ¶ç”Ÿæˆçš„ tokenï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼‰

3. **ä¸ºä»€ä¹ˆç”¨ Automation Token?**
   - âœ… ä¸éœ€è¦ OTPï¼ˆä¸¤æ­¥éªŒè¯ï¼‰
   - âœ… é€‚åˆ CI/CD è‡ªåŠ¨åŒ–
   - âœ… æƒé™è¶³å¤Ÿå‘å¸ƒåŒ…

### æ­¥éª¤ 2: é…ç½® GitHub Secret

1. **æ‰“å¼€ä»“åº“ Settings**:
   `https://github.com/YOUR_ORG/open-agent-sdk/settings/secrets/actions`

2. **æ·»åŠ  Secret**:
   - ç‚¹å‡» "New repository secret"
   - Name: `NPM_TOKEN`
   - Value: ç²˜è´´åˆšæ‰çš„ npm token
   - ç‚¹å‡» "Add secret"

3. **ï¼ˆå¯é€‰ï¼‰æ·»åŠ æµ‹è¯• API Keys**:
   å¦‚æœæƒ³åœ¨ CI ä¸­è¿è¡Œå®Œæ•´æµ‹è¯•ï¼š
   - `OPENAI_API_KEY`
   - `GOOGLE_API_KEY`

### æ­¥éª¤ 3: æ¨é€ Workflow æ–‡ä»¶

```bash
git add .github/workflows/publish-canary.yml
git commit -m "feat(ci): add GitHub Actions for canary publishing"
git push origin main
```

### æ­¥éª¤ 4: éªŒè¯é…ç½®

1. æ‰“å¼€ GitHub Actions é¡µé¢
2. æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡ workflow
3. æŸ¥çœ‹æ˜¯å¦å‘å¸ƒæˆåŠŸ

## ğŸ“Š å®Œæ•´å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Benchmark æµ‹è¯•å®Œæ•´æµç¨‹                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. ä¿®æ”¹ä»£ç 
   â”œâ”€ ä¿®å¤ SDK bug
   â””â”€ æ·»åŠ  CLI åŠŸèƒ½
   â”‚
   â–¼
2. æäº¤å¹¶æ¨é€
   git add .
   git commit -m "fix: xxx"
   git push origin your-branch
   â”‚
   â–¼
3. è§¦å‘ GitHub Actions
   â”œâ”€ æ‰“å¼€ Actions é¡µé¢
   â”œâ”€ é€‰æ‹© "Publish Canary"
   â”œâ”€ é€‰æ‹©ä½ çš„åˆ†æ”¯
   â”œâ”€ å‹¾é€‰ "Skip tests" (å¯é€‰)
   â””â”€ ç‚¹å‡» Run workflow
   â”‚
   â–¼
4. ç­‰å¾…å‘å¸ƒï¼ˆ2-3 åˆ†é’Ÿï¼‰
   â”œâ”€ ç”Ÿæˆ canary ç‰ˆæœ¬å·
   â”œâ”€ è¿è¡Œæµ‹è¯•ï¼ˆå¯é€‰ï¼‰
   â”œâ”€ æ„å»º SDK
   â”œâ”€ å‘å¸ƒ SDK åˆ° npm
   â”œâ”€ ç­‰å¾… npm ç´¢å¼•
   â””â”€ å‘å¸ƒ CLI åˆ° npm
   â”‚
   â–¼
5. åœ¨ Daytona å®‰è£…
   npm install -g @open-agent-sdk/cli@canary
   â”‚
   â–¼
6. è¿è¡Œ Benchmark
   oas benchmark
   â”‚
   â–¼
7. å‘ç°é—®é¢˜ï¼Ÿ
   â””â”€ å›åˆ°æ­¥éª¤ 1
```

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### åœ¨ä»»ä½•åˆ†æ”¯å‘å¸ƒ

ä¸éœ€è¦åˆå¹¶åˆ° mainï¼Œå¯ä»¥ç›´æ¥ä» feature åˆ†æ”¯å‘å¸ƒï¼š

1. Push ä½ çš„ feature åˆ†æ”¯
2. åœ¨ GitHub Actions é€‰æ‹©è¯¥åˆ†æ”¯
3. å‘å¸ƒæµ‹è¯•

### è·³è¿‡æµ‹è¯•

æµ‹è¯•é‡æ„æœŸé—´ï¼Œå¯ä»¥è·³è¿‡æµ‹è¯•å¿«é€Ÿå‘å¸ƒï¼š

- å‹¾é€‰ "Skip tests" é€‰é¡¹
- é€‚åˆå¿«é€Ÿè¿­ä»£

### æŸ¥çœ‹å‘å¸ƒå†å²

```bash
# æŸ¥çœ‹æ‰€æœ‰ canary ç‰ˆæœ¬
npm view open-agent-sdk versions --json | grep canary

# æŸ¥çœ‹å½“å‰ canary ç‰ˆæœ¬
npm view @open-agent-sdk/cli@canary version
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. npm Token å®‰å…¨

- âŒ ä¸è¦æŠŠ token æäº¤åˆ°ä»£ç 
- âŒ ä¸è¦åœ¨æ—¥å¿—ä¸­æ‰“å° token
- âœ… åªå­˜å‚¨åœ¨ GitHub Secrets
- âœ… Token ç±»å‹å¿…é¡»æ˜¯ "Automation"

### 2. åˆ†æ”¯é€‰æ‹©

- âœ… å¯ä»¥ä»ä»»ä½•åˆ†æ”¯å‘å¸ƒ
- âœ… é€‚åˆæµ‹è¯•æœªåˆå¹¶çš„ä»£ç 
- âš ï¸ ç¡®è®¤é€‰æ‹©äº†æ­£ç¡®çš„åˆ†æ”¯

### 3. ç‰ˆæœ¬ç®¡ç†

- Canary æ ¼å¼: `0.1.0-canary.202602271530`
- ä½¿ç”¨ `@canary` tagï¼Œä¸å½±å“ `@latest`
- å»ºè®®å®šæœŸæ¸…ç†æ—§ç‰ˆæœ¬

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜ 1: npm publish å¤±è´¥

**é”™è¯¯**: `npm error code E403`

**è§£å†³**:
1. æ£€æŸ¥ `NPM_TOKEN` æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ token ç±»å‹æ˜¯ "Automation"
3. ç¡®è®¤æœ‰å‘å¸ƒæƒé™

### é—®é¢˜ 2: æ‰¾ä¸åˆ° workflow

**è§£å†³**:
```bash
# ç¡®è®¤æ–‡ä»¶å·²æ¨é€åˆ° main
git checkout main
git pull
ls .github/workflows/publish-canary.yml
```

### é—®é¢˜ 3: CLI æ‰¾ä¸åˆ° SDK ä¾èµ–

**åŸå› **: npm ç´¢å¼•å»¶è¿Ÿ

**è§£å†³**: ç­‰å¾… 1-2 åˆ†é’Ÿåé‡è¯•

## ğŸ“ˆ ä¼˜åŠ¿

ç›¸æ¯”æœ¬åœ°è„šæœ¬å‘å¸ƒï¼š

| ç‰¹æ€§ | æœ¬åœ°è„šæœ¬ | GitHub Actions |
|------|---------|----------------|
| OTP éªŒè¯ | âŒ æ¯æ¬¡éœ€è¦ | âœ… ä¸éœ€è¦ |
| ç¯å¢ƒä¸€è‡´æ€§ | âš ï¸ ä¾èµ–æœ¬åœ°ç¯å¢ƒ | âœ… æ ‡å‡†åŒ–ç¯å¢ƒ |
| å‘å¸ƒæ—¥å¿— | âŒ æœ¬åœ°æŸ¥çœ‹ | âœ… æ°¸ä¹…ä¿å­˜ |
| å›¢é˜Ÿåä½œ | âš ï¸ éœ€è¦æœ¬åœ°æƒé™ | âœ… ç»Ÿä¸€ç®¡ç† |
| é€Ÿåº¦ | âœ… ç«‹å³æ‰§è¡Œ | âš ï¸ éœ€è¦æ’é˜Ÿ |

## ğŸ‰ å®Œæˆï¼

é…ç½®å®Œæˆåï¼š
- ä¿®æ”¹ä»£ç  â†’ æ¨é€ â†’ ç‚¹å‡»æŒ‰é’® â†’ ç­‰å¾… 2 åˆ†é’Ÿ â†’ å®‰è£…æµ‹è¯•
- æ•´ä¸ªæµç¨‹åªéœ€ **5 åˆ†é’Ÿ**ï¼
- ä¸éœ€è¦æ‰‹åŠ¨è¾“å…¥ OTPï¼
- å¯ä»¥åœ¨ä»»ä½•åˆ†æ”¯å¿«é€Ÿæµ‹è¯•ï¼
